import{r as d,o as Q,a as Y,b as c,d as e,w as t,e as o,T as R,U as X,V as Z,m as n,t as u,W as ee,j as x,l as m,p as g,i as te}from"./index-DIgo_7TP.js";import{_ as le}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ae={class:"products-page"},oe=["href"],ne={class:"current-price"},se={key:0,class:"original-price"},ue={class:"pagination-wrapper"},ie={__name:"Products",setup(re){const F=d([]),C=d(!1),z=d(0),p=d(1),P=d(20),D=d(""),S=d(""),b=d(!1),s=d(null),f=i=>i?te(i).format("YYYY-MM-DD HH:mm"):"-",y=async()=>{C.value=!0;try{const i=await R({page:p.value,page_size:P.value,search:D.value||void 0,status:S.value||void 0});F.value=i.data.items,z.value=i.data.total}catch(i){console.error("获取商品失败:",i)}finally{C.value=!1}},k=()=>{p.value=1,y()},j=()=>{p.value=1,y()},I=()=>{y()},K=i=>{s.value=i,b.value=!0},M=()=>{var i;(i=s.value)!=null&&i.url&&window.open(s.value.url,"_blank")};return Q(()=>{y()}),(i,a)=>{const B=o("Search"),h=o("el-icon"),H=o("el-input"),V=o("el-col"),U=o("el-option"),L=o("el-select"),w=o("el-button"),v=o("el-tag"),T=o("el-row"),N=o("el-card"),_=o("el-table-column"),E=o("View"),W=o("el-table"),q=o("el-pagination"),r=o("el-descriptions-item"),A=o("el-descriptions"),G=o("Link"),J=o("el-dialog"),O=X("loading");return c(),Y("div",ae,[e(N,{class:"filter-card"},{default:t(()=>[e(T,{gutter:20},{default:t(()=>[e(V,{span:8},{default:t(()=>[e(H,{modelValue:D.value,"onUpdate:modelValue":a[0]||(a[0]=l=>D.value=l),placeholder:"搜索商品名称...",clearable:"",onClear:k,onKeyup:Z(k,["enter"])},{prefix:t(()=>[e(h,null,{default:t(()=>[e(B)]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(V,{span:6},{default:t(()=>[e(L,{modelValue:S.value,"onUpdate:modelValue":a[1]||(a[1]=l=>S.value=l),placeholder:"状态筛选",clearable:"",onChange:k},{default:t(()=>[e(U,{label:"全部",value:""}),e(U,{label:"在售",value:"active"}),e(U,{label:"已下架",value:"removed"})]),_:1},8,["modelValue"])]),_:1}),e(V,{span:4},{default:t(()=>[e(w,{type:"primary",onClick:k},{default:t(()=>[e(h,null,{default:t(()=>[e(B)]),_:1}),a[6]||(a[6]=n(" 搜索 ",-1))]),_:1})]),_:1}),e(V,{span:6,style:{"text-align":"right"}},{default:t(()=>[e(v,{type:"info",size:"large"},{default:t(()=>[n(" 共 "+u(z.value)+" 件商品 ",1)]),_:1})]),_:1})]),_:1})]),_:1}),e(N,{class:"table-card"},{default:t(()=>[ee((c(),m(W,{data:F.value,stripe:"",style:{width:"100%"}},{default:t(()=>[e(_,{prop:"product_id",label:"商品ID",width:"120"}),e(_,{prop:"name",label:"商品名称","min-width":"250"},{default:t(({row:l})=>[x("a",{href:l.url,target:"_blank",class:"product-link"},u(l.name),9,oe)]),_:1}),e(_,{label:"价格",width:"150"},{default:t(({row:l})=>{var $;return[x("div",null,[x("span",ne,"$"+u((($=l.price)==null?void 0:$.toFixed(2))||"未知"),1),l.original_price&&l.original_price>l.price?(c(),Y("span",se," $"+u(l.original_price.toFixed(2)),1)):g("",!0)]),l.is_on_sale?(c(),m(v,{key:0,type:"danger",size:"small",style:{"margin-top":"5px"}},{default:t(()=>[...a[7]||(a[7]=[n(" 促销 ",-1)])]),_:1})):g("",!0)]}),_:1}),e(_,{label:"状态",width:"100"},{default:t(({row:l})=>[e(v,{type:l.status==="active"?"success":"info"},{default:t(()=>[n(u(l.status==="active"?"在售":"已下架"),1)]),_:2},1032,["type"])]),_:1}),e(_,{label:"首次发现",width:"160"},{default:t(({row:l})=>[n(u(f(l.first_seen_at)),1)]),_:1}),e(_,{label:"最后更新",width:"160"},{default:t(({row:l})=>[n(u(f(l.last_seen_at)),1)]),_:1}),e(_,{label:"操作",width:"100",fixed:"right"},{default:t(({row:l})=>[e(w,{type:"primary",link:"",onClick:$=>K(l)},{default:t(()=>[e(h,null,{default:t(()=>[e(E)]),_:1}),a[8]||(a[8]=n(" 查看 ",-1))]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[O,C.value]]),x("div",ue,[e(q,{"current-page":p.value,"onUpdate:currentPage":a[2]||(a[2]=l=>p.value=l),"page-size":P.value,"onUpdate:pageSize":a[3]||(a[3]=l=>P.value=l),"page-sizes":[20,50,100],total:z.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:j,onCurrentChange:I},null,8,["current-page","page-size","total"])])]),_:1}),e(J,{modelValue:b.value,"onUpdate:modelValue":a[5]||(a[5]=l=>b.value=l),title:"商品详情",width:"500px"},{footer:t(()=>[e(w,{onClick:a[4]||(a[4]=l=>b.value=!1)},{default:t(()=>[...a[9]||(a[9]=[n("关闭",-1)])]),_:1}),e(w,{type:"primary",onClick:M},{default:t(()=>[e(h,null,{default:t(()=>[e(G)]),_:1}),a[10]||(a[10]=n(" 查看原页面 ",-1))]),_:1})]),default:t(()=>[s.value?(c(),m(A,{key:0,column:1,border:""},{default:t(()=>[e(r,{label:"商品ID"},{default:t(()=>[n(u(s.value.product_id),1)]),_:1}),e(r,{label:"商品名称"},{default:t(()=>[n(u(s.value.name),1)]),_:1}),e(r,{label:"当前价格"},{default:t(()=>{var l;return[n("$"+u(((l=s.value.price)==null?void 0:l.toFixed(2))||"未知"),1)]}),_:1}),s.value.original_price?(c(),m(r,{key:0,label:"原价"},{default:t(()=>[n(" $"+u(s.value.original_price.toFixed(2)),1)]),_:1})):g("",!0),e(r,{label:"是否促销"},{default:t(()=>[e(v,{type:s.value.is_on_sale?"danger":"info",size:"small"},{default:t(()=>[n(u(s.value.is_on_sale?"是":"否"),1)]),_:1},8,["type"])]),_:1}),e(r,{label:"状态"},{default:t(()=>[e(v,{type:s.value.status==="active"?"success":"info"},{default:t(()=>[n(u(s.value.status==="active"?"在售":"已下架"),1)]),_:1},8,["type"])]),_:1}),e(r,{label:"首次发现"},{default:t(()=>[n(u(f(s.value.first_seen_at)),1)]),_:1}),e(r,{label:"最后更新"},{default:t(()=>[n(u(f(s.value.last_seen_at)),1)]),_:1}),s.value.removed_at?(c(),m(r,{key:1,label:"下架时间"},{default:t(()=>[n(u(f(s.value.removed_at)),1)]),_:1})):g("",!0)]),_:1})):g("",!0)]),_:1},8,["modelValue"])])}}},ce=le(ie,[["__scopeId","data-v-07593943"]]);export{ce as default};
